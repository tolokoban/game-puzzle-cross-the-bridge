"use strict";(self.webpackChunkpuzzle_cross_the_bridge=self.webpackChunkpuzzle_cross_the_bridge||[]).push([[588],{6527:(e,t,r)=>{r.d(t,{A:()=>s});var a=r(1601),i=r.n(a),n=r(6314),o=r.n(n)()(i());o.push([e.id,".cD9p7HAx8bXvNh_nMcyw > canvas {\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n}\n",""]),o.locals={main:"cD9p7HAx8bXvNh_nMcyw"};const s=o},6588:(e,t,r)=>{r.r(t),r.d(t,{default:()=>I});var a=r(4848),i=r(6540),n=r(2984),o=r(8803),s=r(2772);class u extends n.tb{static getTextureId(e){if(u.textureIds.has(e))return u.textureIds.get(e);{const t=`PainterObject/${u.textureIds.size}`;return u.textureIds.set(e,t),t}}constructor(e,{glbContent:t,meshIndex:r=0,primitiveIndex:a=0,textureImage:i}){var o;super(),this.context=e,this.matrixTransfo=new n.MC,this.paint=()=>{const{context:e,prg:t,count:r,matrixTransfo:a,texture:i}=this,{gl:n,camera:o}=e;n.enable(n.CULL_FACE),n.cullFace(n.BACK),t.use(),t.uniformMatrix4fv("uniTransfoMatrix",a),t.uniformMatrix4fv("uniModelViewMatrix",o.matrixModelView),t.uniformMatrix4fv("uniProjectionMatrix",o.matrixProjection),i.activate(t,"uniTexture"),this.vao.bind(),n.drawElements(n.TRIANGLES,r,this.elementsType,0),this.vao.unbind()},this.texture=e.textures2D.create({image:i,wrapR:"CLAMP_TO_EDGE",wrapS:"CLAMP_TO_EDGE"},u.getTextureId(i));const s=new n.dL({uniforms:{uniTransfoMatrix:"mat4",uniModelViewMatrix:"mat4",uniProjectionMatrix:"mat4"},attributes:{attPos:"vec4",attUV:"vec2"},varying:{varUV:"vec2"},functions:{},mainCode:["varUV = attUV;","gl_Position = uniProjectionMatrix * uniModelViewMatrix * uniTransfoMatrix * attPos;"]}).code,c=new n.NI({outputs:{FragColor:"vec4"},varying:{varUV:"vec2"},uniforms:{uniTexture:"sampler2D"},mainCode:["FragColor = texture(uniTexture, varUV);"]}).code,l=e.programs.create({vert:s,frag:c});this.prg=l;const x=new n.FX(t),v=x.getMeshPrimitive(r,a),{POSITION:d,TEXCOORD_0:m}=v.attributes,f=null!==(o=v.indices)&&void 0!==o?o:2,h=new n.I9({attPos:"vec3",attUV:"vec2"});h.set("attPos",x.getBufferViewData(d)),h.set("attUV",x.getBufferViewData(m));const g=x.getBufferViewData(f);this.elementsType=(0,n.Lm)(g),this.vao=e.createVAO(l,[h],g),this.count=g.length}delete(){this.vao.delete()}}u.textureIds=new Map;class c extends n.tb{constructor(e,{glbContent:t,meshIndex:r=0,primitiveIndex:a=0,textureImage:i}){var o;super(),this.context=e,this.matrixTransfo=new n.MC,this.paint=e=>{const{context:t,prg:r,count:a,matrixTransfo:i,texture:n}=this,{gl:o,camera:s}=t;o.enable(o.CULL_FACE),o.cullFace(o.BACK),r.use(),r.uniform1f("uniTime",.001*e),r.uniformMatrix4fv("uniTransfoMatrix",i),r.uniformMatrix4fv("uniModelViewMatrix",s.matrixModelView),r.uniformMatrix4fv("uniProjectionMatrix",s.matrixProjection),n.activate(r,"uniTexture"),this.vao.bind(),o.drawElements(o.TRIANGLES,a,this.elementsType,0),this.vao.unbind()},this.texture=e.textures2D.create({image:i,wrapR:"REPEAT",wrapS:"REPEAT"},"PainterRiver");const s=new n.dL({uniforms:{uniTime:"float",uniTransfoMatrix:"mat4",uniModelViewMatrix:"mat4",uniProjectionMatrix:"mat4"},attributes:{attPos:"vec4",attUV:"vec2"},varying:{varUV:"vec2",varSpec:"float"},functions:{},mainCode:["varUV = attUV + vec2(0.0, uniTime);","float x = attPos.x;","float y = attPos.y;","float z = attPos.z;","float X = sin(uniTime * 3.0 + x * 1.0 + cos(z));","float Z = sin(uniTime * 50.0 + z * 3.0);","varSpec = ((X + Z) * 0.2) + 0.5;","varSpec = pow(varSpec, 6.0);","vec4 pos = vec4(",["x,",".1 * (X + Z) + y,","z,","1"],");","gl_Position = uniProjectionMatrix * uniModelViewMatrix * uniTransfoMatrix * pos;"]}).code,u=new n.NI({outputs:{FragColor:"vec4"},varying:{varUV:"vec2",varSpec:"float"},uniforms:{uniTexture:"sampler2D"},mainCode:["vec4 color = texture(uniTexture, varUV);","FragColor = vec4(color.rgb + vec3(varSpec) , color.a);"]}).code,c=e.programs.create({vert:s,frag:u});this.prg=c;const l=new n.FX(t),x=l.getMeshPrimitive(r,a),{POSITION:v,TEXCOORD_0:d}=x.attributes,m=null!==(o=x.indices)&&void 0!==o?o:2,f=new n.I9({attPos:"vec3",attUV:"vec2"});f.set("attPos",l.getBufferViewData(v)),f.set("attUV",l.getBufferViewData(d));const h=l.getBufferViewData(m);this.elementsType=(0,n.Lm)(h),this.vao=e.createVAO(c,[f],h),this.count=h.length}delete(){this.vao.delete()}}var l=r(5072),x=r.n(l),v=r(7825),d=r.n(v),m=r(7659),f=r.n(m),h=r(5056),g=r.n(h),p=r(540),w=r.n(p),M=r(1113),T=r.n(M),b=r(6527),P={};P.styleTagTransform=T(),P.setAttributes=g(),P.insert=f().bind(null,"head"),P.domAPI=d(),P.insertStyleElement=w(),x()(b.A,P);const V=b.A&&b.A.locals?b.A.locals:void 0;function I(){const e=(0,s.Z)(),[t,r]=(0,i.useState)(null);return function(e,t){i.useEffect((()=>{if(!e||!t)return;const r=new n.tf(t),a=new n.xN({distance:6,far:1e3,fovy:.35*Math.PI,near:.001,target:new n.hN(0,1,0)});a.orbitAroundX(-.1),r.camera=a;const i=new u(r,{glbContent:e.worldMesh,textureImage:e.worldTexture}),o=new u(r,{glbContent:e.bridgeMesh,textureImage:e.bridgeTexture}),s=new c(r,{glbContent:e.riverMesh,textureImage:e.riverTexture});r.add(new n.o5(r,{depth:1,color:[1,.7,0,1]}),new n.AN(r,{enabled:!0}),o,i,new n.b6(r,r.textures2D.create({image:e.background},"Background")),new n.Ip(r,{children:[s],blend:"sprite"})),r.animSchedule({action(e){const t=1.5*Math.sin(2*Math.PI*e);r.camera.setShift(t,0,0)},duration:18e3,repeat:30}),r.paint()}),[e,t])}(e,t),(0,a.jsx)(o.sWC,{position:"absolute",fullsize:!0,color:"neutral-1",className:V.main,children:(0,a.jsx)("canvas",{ref:r})})}}}]);